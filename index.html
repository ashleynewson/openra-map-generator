<html>
  <head>
    <title>RA map generator prototype</title>
    <script type="module" src="main.js"></script>
    <style>
      canvas {
          image-rendering: pixelated;
      }
    </style>
  </head>
  <body>
    <h1>OpenRA Random Map Generator Prototype</h2>
    <p>Copyright Ashley Newson 2024.</p>
    <input id="preview-size" type="range" min="0" value="512" max="1024" step="64" onchange="resizePreview()"><label>Preview size</label><br>
    <span id="status-line"></span>
    <span style="visibility:hidden;" id="save-links">
      <a id="saveBin" download="map.bin" href='#'>Save map.bin</a>
      <a id="saveYaml" download="map.yaml" href='#'>Save map.yaml</a>
      <a id="savePng" download="map.png" href='#'>Save map.png</a>
    </span>
    <br>
    <a id="linkToMap" href='#'>Link to this map</a>
    <br>
    <div>
      <canvas style="border: 8px solid;" id="canvas" width="64" height="64"></canvas>
    </div>
    <script>
      function resizePreview() {
          const canvas = document.getElementById("canvas");
          const previewSize = document.getElementById("preview-size").value;
          canvas.style.width = `${previewSize}px`;
          canvas.style.height = `${previewSize}px`;
      }
      resizePreview();
    </script>
    <button onclick="beginGenerate()">Generate</button>
    <button onclick="randomSeed();beginGenerate();">Generate with random seed</button>
    <select id="preset" onchange="configurePreset(true);">
      <option value="placeholder" selected>Generate random from preset</option>
      <option value="---">---</option>
      <option value="random">Random preset</option>
      <option value="---">---</option>
      <option value="basic">Basic</option>
      <option value="---">---</option>
      <option value="plains">Plains</option>
      <option value="wetlands">Wetlands</option>
      <option value="wetlands-narrow">Narrow Wetlands (slow)</option>
      <option value="puddles">Puddles</option>
      <option value="oceanic">Oceanic</option>
      <option value="lake-district">Lake District</option>
    </select>
    <br>
    <p>Primary settings:</p>
    <input id="setting-seed"><label>Seed</label><br>
    <input id="setting-size"><label>Size</label><br>
    <input id="setting-rotations"><label>Rotations (minimum 1)</label><br>
    <input id="setting-mirror"><label>Mirror direction (0 (none), 1, 2, 3, 4)</label><br>
    <input id="setting-players-per-rotation"><label>Players per rotation</label><br>
    <p>Terrain settings:</p>
    <input id="setting-wavelength-scale"><label>Terrain noise wavelength scale</label><br>
    <input id="setting-water"><label>Water fraction</label><br>
    <input id="setting-mountains"><label>Mountain fraction</label><br>
    <input id="setting-terrain-smoothing"><label>Terrain smoothing</label><br>
    <input id="setting-smoothing-threshold"><label>Iterative smoothing threshold</label><br>
    <input id="setting-minimum-land-sea-thickness"><label>Minimum land/sea terrain thickness</label><br>
    <input id="setting-minimum-mountain-thickness"><label>Minimum mountain terrain thickness</label><br>
    <input id="setting-maximum-altitude"><label>Maximum mountain altitude</label><br>
    <input id="setting-roughness-radius"><label>Terrain roughness sampling distance (terrain elevation variance sampling distance)</label><br>
    <input id="setting-roughness"><label>Terrain roughness (cliffiness of mountain contours)</label><br>
    <input id="setting-minimum-terrain-contour-spacing"><label>Minimum distance between terrain contours</label><br>
    <input id="setting-minimum-cliff-length"><label>Minimum cliff length</label><br>
    <input id="setting-enforce-symmetry" type="checkbox"><label>Enforce symmetry of terrain availability with entities</label><br>
    <p>Entity settings:</p>
    <input id="setting-create-entities" type="checkbox"><label>Create entities</label><br>
    <input id="setting-starting-mines"><label>Starting mines</label><br>
    <input id="setting-starting-ore"><label>Starting ore</label><br>
    <input id="setting-central-reservation"><label>Central/Mirror player reservation</label><br>
    <input id="setting-spawn-region-size"><label>Spawn region size</label><br>
    <input id="setting-spawn-build-size"><label>Spawn build size</label><br>
    <input id="setting-spawn-mines"><label>Number of spawn ore mines</label><br>
    <input id="setting-spawn-ore"><label>Spawn ore size</label><br>
    <input id="setting-maximum-expansions"><label>Maximum expansion count</label><br>
    <input id="setting-minimum-expansion-size"><label>Minimum expansion size</label><br>
    <input id="setting-maximum-expansion-size"><label>Maximum expansion size</label><br>
    <input id="setting-expansion-inner"><label>Expansion inner size</label><br>
    <input id="setting-expansion-border"><label>Expansion border size</label><br>
    <input id="setting-expansion-mines"><label>Expansion extra mine weight</label><br>
    <input id="setting-expansion-ore"><label>Expansion ore size</label><br>
    <input id="setting-maximum-buildings"><label>Maximum neutral building count</label><br>

    <button onclick="settingsToJson()">Dump settings to JSON</button>
    <button onclick="jsonToSettings(false)">Load settings from JSON</button>
    <button onclick="jsonToSettings(true)">Load and generate</button>
    <br>
    <textarea id="settings-json"></textarea>
    <hr>
    <h3>Debugging information</h3>
    <div id="debug"></div>
    <pre>
Seed list:
-2024525772
127531097
1574961058
1936200760
639876195
594113115
1031828710
1540134231
1865077859
221031888
995298775
56044641 (thin masses)
-877769920 @ wavelength 0.2
-506412402 @ wavelength 0.25 (bi-stable thin masses)
810287738 (I just like the look of it)
679141286 (couple of ponds)
2127732142 (tiling fails)
270145234 (lake @ water 0.25)
-1936116975 (size 128, 0.35 water, 0.3 wavelength)
-88112732 (shortcircuit. size 128, 0.35 water, 0.1 wavelength)
813543009 (random crash?)
1809431707 (broken coastline. wavelength 0.2)
182620986 (puddles)
    </pre>
  </body>
</html>
